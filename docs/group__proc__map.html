<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>taiHEN: Process Map Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">taiHEN
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">CFW framework for PS Vita</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Process Map Interface</div>  </div>
</div><!--header-->
<div class="contents">

<p>Data structure for storing patches internally.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__tai__proc__map.html">_tai_proc_map</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual map in memory.  <a href="struct__tai__proc__map.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__tai__proc.html">_tai_proc</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal data for a process.  <a href="struct__tai__proc.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga788b7fe348859b8e702587d703c563f2"><td class="memItemLeft" align="right" valign="top"><a id="ga788b7fe348859b8e702587d703c563f2"></a>
typedef struct <a class="el" href="struct__tai__proc__map.html">_tai_proc_map</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a></td></tr>
<tr class="memdesc:ga788b7fe348859b8e702587d703c563f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual map in memory. <br /></td></tr>
<tr class="separator:ga788b7fe348859b8e702587d703c563f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21442ef0ac405d129419ed2afe4ef90a"><td class="memItemLeft" align="right" valign="top"><a id="ga21442ef0ac405d129419ed2afe4ef90a"></a>
typedef struct <a class="el" href="struct__tai__proc.html">_tai_proc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga21442ef0ac405d129419ed2afe4ef90a">tai_proc_t</a></td></tr>
<tr class="memdesc:ga21442ef0ac405d129419ed2afe4ef90a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal data for a process. <br /></td></tr>
<tr class="separator:ga21442ef0ac405d129419ed2afe4ef90a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3d50f30aab767e86bc3ca06b66f42648"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga3d50f30aab767e86bc3ca06b66f42648">proc_map_init</a> (void)</td></tr>
<tr class="memdesc:ga3d50f30aab767e86bc3ca06b66f42648"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the map system.  <a href="#ga3d50f30aab767e86bc3ca06b66f42648">More...</a><br /></td></tr>
<tr class="separator:ga3d50f30aab767e86bc3ca06b66f42648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e6a1d9f86e64b2838e0b473277d009b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga1e6a1d9f86e64b2838e0b473277d009b">proc_map_deinit</a> (void)</td></tr>
<tr class="memdesc:ga1e6a1d9f86e64b2838e0b473277d009b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans up the map system.  <a href="#ga1e6a1d9f86e64b2838e0b473277d009b">More...</a><br /></td></tr>
<tr class="separator:ga1e6a1d9f86e64b2838e0b473277d009b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7ec61155a581c458091c52b1710e5ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#gad7ec61155a581c458091c52b1710e5ba">proc_map_alloc</a> (int nbuckets)</td></tr>
<tr class="memdesc:gad7ec61155a581c458091c52b1710e5ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a new map.  <a href="#gad7ec61155a581c458091c52b1710e5ba">More...</a><br /></td></tr>
<tr class="separator:gad7ec61155a581c458091c52b1710e5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4dc9cd49a81e8b150e8b3544c662b408"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga4dc9cd49a81e8b150e8b3544c662b408">proc_map_free</a> (<a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *map)</td></tr>
<tr class="memdesc:ga4dc9cd49a81e8b150e8b3544c662b408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a map.  <a href="#ga4dc9cd49a81e8b150e8b3544c662b408">More...</a><br /></td></tr>
<tr class="separator:ga4dc9cd49a81e8b150e8b3544c662b408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe7a6717563da0a06ccc89c793eade04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#gabe7a6717563da0a06ccc89c793eade04">proc_map_try_insert</a> (<a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *map, <a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> *patch, <a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> **existing)</td></tr>
<tr class="memdesc:gabe7a6717563da0a06ccc89c793eade04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts into the map if no overlap or get patch that completely overlaps.  <a href="#gabe7a6717563da0a06ccc89c793eade04">More...</a><br /></td></tr>
<tr class="separator:gabe7a6717563da0a06ccc89c793eade04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67f2f62deb998b5ba45e21a5c9b995a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga67f2f62deb998b5ba45e21a5c9b995a3">proc_map_remove_all_pid</a> (<a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *map, SceUID pid, <a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> **head)</td></tr>
<tr class="memdesc:ga67f2f62deb998b5ba45e21a5c9b995a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes every patch associated with a given pid from the map.  <a href="#ga67f2f62deb998b5ba45e21a5c9b995a3">More...</a><br /></td></tr>
<tr class="separator:ga67f2f62deb998b5ba45e21a5c9b995a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ef027ff09e49a3cf320e0f8665a7657"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proc__map.html#ga8ef027ff09e49a3cf320e0f8665a7657">proc_map_remove</a> (<a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *map, <a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> *patch)</td></tr>
<tr class="memdesc:ga8ef027ff09e49a3cf320e0f8665a7657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a single patch from the map.  <a href="#ga8ef027ff09e49a3cf320e0f8665a7657">More...</a><br /></td></tr>
<tr class="separator:ga8ef027ff09e49a3cf320e0f8665a7657"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Data structure for storing patches internally. </p>
<p>Internal map structure</p>
<p>This is a thread-safe map data structure for keeping track of mappings from PID to a linked-list of patches (stored in <code>tai_proc_t</code>). </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gad7ec61155a581c458091c52b1710e5ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad7ec61155a581c458091c52b1710e5ba">&sect;&nbsp;</a></span>proc_map_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a>* proc_map_alloc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbuckets</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a new map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nbuckets</td><td>The number of buckets for the map.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to an allocated map structure on success. Null on failure. </dd></dl>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00069">69</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
<a id="ga1e6a1d9f86e64b2838e0b473277d009b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e6a1d9f86e64b2838e0b473277d009b">&sect;&nbsp;</a></span>proc_map_deinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void proc_map_deinit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleans up the map system. </p>
<p>Should be called before exit. </p>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00056">56</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
<a id="ga4dc9cd49a81e8b150e8b3544c662b408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4dc9cd49a81e8b150e8b3544c662b408">&sect;&nbsp;</a></span>proc_map_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void proc_map_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The map </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00089">89</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
<a id="ga3d50f30aab767e86bc3ca06b66f42648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3d50f30aab767e86bc3ca06b66f42648">&sect;&nbsp;</a></span>proc_map_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int proc_map_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the map system. </p>
<p>Must be called on startup.</p>
<dl class="section return"><dt>Returns</dt><dd>Zero on success or memory allocation error code. </dd></dl>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00038">38</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
<a id="ga8ef027ff09e49a3cf320e0f8665a7657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ef027ff09e49a3cf320e0f8665a7657">&sect;&nbsp;</a></span>proc_map_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int proc_map_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> *&#160;</td>
          <td class="paramname"><em>patch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a single patch from the map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The map </td></tr>
    <tr><td class="paramname">patch</td><td>The patch to remove</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One if the patch was removed from the map and zero otherwise. </dd></dl>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00233">233</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
<a id="ga67f2f62deb998b5ba45e21a5c9b995a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67f2f62deb998b5ba45e21a5c9b995a3">&sect;&nbsp;</a></span>proc_map_remove_all_pid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int proc_map_remove_all_pid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> **&#160;</td>
          <td class="paramname"><em>head</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes every patch associated with a given pid from the map. </p>
<p>Returned is a new linked list containing every patch that has been removed from the proc map. Use the <code>next</code> pointer to iterate this linked list.</p>
<p>Since this invalidates all references for a PID, it should ONLY be called on the shutdown of a process. In other words, after calling this, any pointer reference for that process is invalid!</p>
<p>Also note that for optimization, all pointers to <code>slab</code> in the list are considered invalid! Maybe we should null the pointers out in the future.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">map</td><td>The map </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pid</td><td>The pid to remove </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">head</td><td>The head of the linked list contained items removed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One if any item has been removed. </dd></dl>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00202">202</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
<a id="gabe7a6717563da0a06ccc89c793eade04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe7a6717563da0a06ccc89c793eade04">&sect;&nbsp;</a></span>proc_map_try_insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int proc_map_try_insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__proc__map.html#ga788b7fe348859b8e702587d703c563f2">tai_proc_map_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> *&#160;</td>
          <td class="paramname"><em>patch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a> **&#160;</td>
          <td class="paramname"><em>existing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts into the map if no overlap or get patch that completely overlaps. </p>
<p>If there is no overlap with any other element for a given PID, then insert the patch into the map. If there is overlap, the function will return zero and not insert the patch. If the overlap is complete (same address and size), then this will return a pointer to the overlapping patch also.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">map</td><td>The map </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">patch</td><td>The patch to attempt insert </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">existing</td><td>If and only if there exists a patch with the same address and size, then the function returns zero and this pointer will be set to the patch that overlaps. Otherwise, this will output null.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>One if patch has been inserted successfully. Zero if there is overlap and is not inserted. </dd></dl>

<p>Definition at line <a class="el" href="proc__map_8c_source.html#l00114">114</a> of file <a class="el" href="proc__map_8c_source.html">proc_map.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
