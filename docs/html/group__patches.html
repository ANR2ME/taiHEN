<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>taiHEN: Patch System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">taiHEN
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">CFW framework for PS Vita</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Patch System</div>  </div>
</div><!--header-->
<div class="contents">

<p>Main patch system.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__tai__hook.html">_tai_hook</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hook data stored in address space of process to patch.  <a href="struct__tai__hook.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__tai__inject.html">_tai_inject</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Injection data.  <a href="struct__tai__inject.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__tai__hook__list.html">_tai_hook_list</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A chain of hooks.  <a href="struct__tai__hook__list.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__tai__patch.html">_tai_patch</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A patch containing either a hook chain or an injection.  <a href="struct__tai__patch.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gad9ec914d3ad829f14c5267bab476cdd1"><td class="memItemLeft" align="right" valign="top"><a id="gad9ec914d3ad829f14c5267bab476cdd1"></a>
typedef struct <a class="el" href="struct__tai__hook.html">_tai_hook</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gad9ec914d3ad829f14c5267bab476cdd1">tai_hook_t</a></td></tr>
<tr class="memdesc:gad9ec914d3ad829f14c5267bab476cdd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hook data stored in address space of process to patch. <br /></td></tr>
<tr class="separator:gad9ec914d3ad829f14c5267bab476cdd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9a6e7830bbe4a40e4f201941d5fc974"><td class="memItemLeft" align="right" valign="top"><a id="gaa9a6e7830bbe4a40e4f201941d5fc974"></a>
typedef struct <a class="el" href="struct__tai__inject.html">_tai_inject</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gaa9a6e7830bbe4a40e4f201941d5fc974">tai_inject_t</a></td></tr>
<tr class="memdesc:gaa9a6e7830bbe4a40e4f201941d5fc974"><td class="mdescLeft">&#160;</td><td class="mdescRight">Injection data. <br /></td></tr>
<tr class="separator:gaa9a6e7830bbe4a40e4f201941d5fc974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00d8410aecf87d1d7318d3dbaec40757"><td class="memItemLeft" align="right" valign="top"><a id="ga00d8410aecf87d1d7318d3dbaec40757"></a>
typedef struct <a class="el" href="struct__tai__hook__list.html">_tai_hook_list</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#ga00d8410aecf87d1d7318d3dbaec40757">tai_hook_list_t</a></td></tr>
<tr class="memdesc:ga00d8410aecf87d1d7318d3dbaec40757"><td class="mdescLeft">&#160;</td><td class="mdescRight">A chain of hooks. <br /></td></tr>
<tr class="separator:ga00d8410aecf87d1d7318d3dbaec40757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae49fbabc12738a7af2fd7e6394697931"><td class="memItemLeft" align="right" valign="top"><a id="gae49fbabc12738a7af2fd7e6394697931"></a>
typedef struct <a class="el" href="struct__tai__patch.html">_tai_patch</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gae49fbabc12738a7af2fd7e6394697931">tai_patch_t</a></td></tr>
<tr class="memdesc:gae49fbabc12738a7af2fd7e6394697931"><td class="mdescLeft">&#160;</td><td class="mdescRight">A patch containing either a hook chain or an injection. <br /></td></tr>
<tr class="separator:gae49fbabc12738a7af2fd7e6394697931"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga95a9b76739fd6483083af76f85c92f5f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#ga95a9b76739fd6483083af76f85c92f5f">tai_patch_type_t</a> { <b>HOOKS</b>, 
<b>INJECTION</b>
 }</td></tr>
<tr class="separator:ga95a9b76739fd6483083af76f85c92f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2339034285a3cc1ee8b357f647b80196"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#ga2339034285a3cc1ee8b357f647b80196">patches_init</a> (void)</td></tr>
<tr class="memdesc:ga2339034285a3cc1ee8b357f647b80196"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the patch system.  <a href="#ga2339034285a3cc1ee8b357f647b80196">More...</a><br /></td></tr>
<tr class="separator:ga2339034285a3cc1ee8b357f647b80196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdfba119cff8a8d28ba4a873ad3e1dc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gafdfba119cff8a8d28ba4a873ad3e1dc0">patches_deinit</a> (void)</td></tr>
<tr class="memdesc:gafdfba119cff8a8d28ba4a873ad3e1dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans up the patch system.  <a href="#gafdfba119cff8a8d28ba4a873ad3e1dc0">More...</a><br /></td></tr>
<tr class="separator:gafdfba119cff8a8d28ba4a873ad3e1dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3dbb279cb05108c0678c0a2ad16fc88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gaf3dbb279cb05108c0678c0a2ad16fc88">cache_flush</a> (SceUID pid, uintptr_t vma, size_t len)</td></tr>
<tr class="memdesc:gaf3dbb279cb05108c0678c0a2ad16fc88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush L1 and L2 cache for an address.  <a href="#gaf3dbb279cb05108c0678c0a2ad16fc88">More...</a><br /></td></tr>
<tr class="separator:gaf3dbb279cb05108c0678c0a2ad16fc88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaabeaed53094f6b911cfee247949df6f2"><td class="memItemLeft" align="right" valign="top">SceUID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gaabeaed53094f6b911cfee247949df6f2">tai_hook_func_abs</a> (<a class="el" href="group__hook.html#gac10ef3a300e9826453a63ed3c1f0cc3f">tai_hook_ref_t</a> *p_hook, SceUID pid, void *dest_func, const void *hook_func)</td></tr>
<tr class="memdesc:gaabeaed53094f6b911cfee247949df6f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a hook given an absolute address and PID of the function.  <a href="#gaabeaed53094f6b911cfee247949df6f2">More...</a><br /></td></tr>
<tr class="separator:gaabeaed53094f6b911cfee247949df6f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b6c516601a5a0bc08ff5477fa7e49b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#ga7b6c516601a5a0bc08ff5477fa7e49b7">tai_hook_release</a> (SceUID uid, <a class="el" href="group__hook.html#gac10ef3a300e9826453a63ed3c1f0cc3f">tai_hook_ref_t</a> hook_ref)</td></tr>
<tr class="memdesc:ga7b6c516601a5a0bc08ff5477fa7e49b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes a hook and restores original function if chain is empty.  <a href="#ga7b6c516601a5a0bc08ff5477fa7e49b7">More...</a><br /></td></tr>
<tr class="separator:ga7b6c516601a5a0bc08ff5477fa7e49b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadaebd136f982eab5433cf32e20f64d84"><td class="memItemLeft" align="right" valign="top">SceUID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gadaebd136f982eab5433cf32e20f64d84">tai_inject_abs</a> (SceUID pid, void *dest, const void *src, size_t size)</td></tr>
<tr class="memdesc:gadaebd136f982eab5433cf32e20f64d84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a raw data injection given an absolute address and PID of the address space.  <a href="#gadaebd136f982eab5433cf32e20f64d84">More...</a><br /></td></tr>
<tr class="separator:gadaebd136f982eab5433cf32e20f64d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1e0cc3e65a3cadd10e8c478d136581c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gab1e0cc3e65a3cadd10e8c478d136581c">tai_inject_release</a> (SceUID uid)</td></tr>
<tr class="memdesc:gab1e0cc3e65a3cadd10e8c478d136581c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes an injection and restores the original data.  <a href="#gab1e0cc3e65a3cadd10e8c478d136581c">More...</a><br /></td></tr>
<tr class="separator:gab1e0cc3e65a3cadd10e8c478d136581c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf1df3d13449f89e9e6eaeb7fe0569b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__patches.html#gaaf1df3d13449f89e9e6eaeb7fe0569b2">tai_try_cleanup_process</a> (SceUID pid)</td></tr>
<tr class="memdesc:gaaf1df3d13449f89e9e6eaeb7fe0569b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called on process exist to force remove private hooks.  <a href="#gaaf1df3d13449f89e9e6eaeb7fe0569b2">More...</a><br /></td></tr>
<tr class="separator:gaaf1df3d13449f89e9e6eaeb7fe0569b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Main patch system. </p>
<p>Modify read-only and executable memory</p>
<p>There are two kinds of patches. Injections are raw modifications to any memory address (including read-only) memory. Once an injection is inserted, nobody else can inject that memory address for that process. The original data is saved and when the injection is released, the it is written back. Hooks are handled by <a href="http://github.com/comex/substitute">substitute</a> and one function can have multiple hooks chained together. This allows many plugins to hook the same function. Function hooks allow the plugin to run any code before and after a function is called. </p>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga95a9b76739fd6483083af76f85c92f5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga95a9b76739fd6483083af76f85c92f5f">&sect;&nbsp;</a></span>tai_patch_type_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__patches.html#ga95a9b76739fd6483083af76f85c92f5f">tai_patch_type_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Type of patch </p>

<p>Definition at line <a class="el" href="taihen__internal_8h_source.html#l00037">37</a> of file <a class="el" href="taihen__internal_8h_source.html">taihen_internal.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf3dbb279cb05108c0678c0a2ad16fc88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf3dbb279cb05108c0678c0a2ad16fc88">&sect;&nbsp;</a></span>cache_flush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cache_flush </td>
          <td>(</td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>vma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flush L1 and L2 cache for an address. </p>
<p>For thread safety, interrupts may be disabled for the duration of this call. That plus the act of cache flushing itself makes this an expensive operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pid</td><td>The pid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vma</td><td>The vma </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>The length </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00125">125</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="gafdfba119cff8a8d28ba4a873ad3e1dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafdfba119cff8a8d28ba4a873ad3e1dc0">&sect;&nbsp;</a></span>patches_deinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void patches_deinit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleans up the patch system. </p>
<p>Should be called before exit. </p>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00102">102</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="ga2339034285a3cc1ee8b357f647b80196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2339034285a3cc1ee8b357f647b80196">&sect;&nbsp;</a></span>patches_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int patches_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the patch system. </p>
<p>Requires <code>proc_map_init</code> to be called first! Should be called on startup.</p>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, &lt; 0 on error </dd></dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00071">71</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="gaabeaed53094f6b911cfee247949df6f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaabeaed53094f6b911cfee247949df6f2">&sect;&nbsp;</a></span>tai_hook_func_abs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SceUID tai_hook_func_abs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__hook.html#gac10ef3a300e9826453a63ed3c1f0cc3f">tai_hook_ref_t</a> *&#160;</td>
          <td class="paramname"><em>p_hook</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dest_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>hook_func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts a hook given an absolute address and PID of the function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">p_hook</td><td>Outputs a reference object if successful </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pid</td><td>PID of the address space to hook </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dest_func</td><td>The destination function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hook_func</td><td>The hook function</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UID for the hook on success, &lt; 0 on error </dd></dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00385">385</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="ga7b6c516601a5a0bc08ff5477fa7e49b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b6c516601a5a0bc08ff5477fa7e49b7">&sect;&nbsp;</a></span>tai_hook_release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tai_hook_release </td>
          <td>(</td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__hook.html#gac10ef3a300e9826453a63ed3c1f0cc3f">tai_hook_ref_t</a>&#160;</td>
          <td class="paramname"><em>hook_ref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes a hook and restores original function if chain is empty. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uid</td><td>The uid reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hook_ref</td><td>The hook</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, &lt; 0 on error </dd></dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00474">474</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="gadaebd136f982eab5433cf32e20f64d84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadaebd136f982eab5433cf32e20f64d84">&sect;&nbsp;</a></span>tai_inject_abs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SceUID tai_inject_abs </td>
          <td>(</td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts a raw data injection given an absolute address and PID of the address space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pid</td><td>The pid of the src and dest pointers address space </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dest</td><td>The destination </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>The source </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>The size</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UID for the injection on success, &lt; 0 on error<ul>
<li>TAI_ERROR_PATCH_EXISTS if a hook or injection is already inserted </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00525">525</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="gab1e0cc3e65a3cadd10e8c478d136581c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab1e0cc3e65a3cadd10e8c478d136581c">&sect;&nbsp;</a></span>tai_inject_release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tai_inject_release </td>
          <td>(</td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>uid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes an injection and restores the original data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inject</td><td>The injection</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, &lt; 0 on error </dd></dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00589">589</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
<a id="gaaf1df3d13449f89e9e6eaeb7fe0569b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf1df3d13449f89e9e6eaeb7fe0569b2">&sect;&nbsp;</a></span>tai_try_cleanup_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tai_try_cleanup_process </td>
          <td>(</td>
          <td class="paramtype">SceUID&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called on process exist to force remove private hooks. </p>
<p>It is the caller's responsibilty to clean up before it terminates! However in the case where that doesn't happen, we try to salvage the situation by manually freeing all patches for a PID. This is a dirty free that does not attempt to write back the original data, so it should only be used at process termination. THIS NOT NOTE FREE PUBLIC HOOKS! There is no free way of keeping track of which PIDs have handles to a public hook internally, so we assume that public hooks stay resident forever unless the release call is made by the caller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pid</td><td>The pid</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero always </dd></dl>

<p>Definition at line <a class="el" href="patches_8c_source.html#l00644">644</a> of file <a class="el" href="patches_8c_source.html">patches.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
